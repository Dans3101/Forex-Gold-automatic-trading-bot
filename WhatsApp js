// whatsapp.js
import qrcode from "qrcode-terminal";
import pkg from "whatsapp-web.js";
const { Client, LocalAuth } = pkg;

const client = new Client({
    authStrategy: new LocalAuth(),
    puppeteer: { headless: true }
});

client.on("qr", (qr) => {
    console.log("üì≤ Scan this QR with your WhatsApp:");
    qrcode.generate(qr, { small: true });
});

client.on("ready", () => {
    console.log("‚úÖ WhatsApp bot is ready!");
});

// Function to send signal to a WhatsApp group
export const sendSignalToGroup = async (groupName, signal) => {
    try {
        const chats = await client.getChats();
        const group = chats.find(c => c.isGroup && c.name === groupName);

        if (group) {
            await client.sendMessage(group.id._serialized, signal);
            console.log(`üì§ Sent signal to group: ${groupName}`);
        } else {
            console.log("‚ö†Ô∏è Group not found, check the name!");
        }
    } catch (err) {
        console.error("‚ùå Error sending signal:", err);
    }
};

client.initialize();